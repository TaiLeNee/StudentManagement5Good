# HÆ°á»›ng dáº«n sá»­ dá»¥ng há»‡ thá»‘ng xuáº¥t bÃ¡o cÃ¡o Ä‘Æ¡n giáº£n

## Tá»•ng quan

Há»‡ thá»‘ng xuáº¥t bÃ¡o cÃ¡o Ä‘Æ¡n giáº£n Ä‘Ã£ Ä‘Æ°á»£c táº¡o Ä‘á»ƒ thay tháº¿ EPPlus, sá»­ dá»¥ng **ClosedXML** - má»™t thÆ° viá»‡n miá»…n phÃ­ vÃ  Ä‘Æ¡n giáº£n hÆ¡n Ä‘á»ƒ xuáº¥t Excel.

## CÃ¡c tÃ­nh nÄƒng chÃ­nh

### 1. Xuáº¥t bÃ¡o cÃ¡o danh sÃ¡ch sinh viÃªn 5 tá»‘t
- **MÃ´ táº£**: Xuáº¥t danh sÃ¡ch táº¥t cáº£ sinh viÃªn vá»›i thÃ´ng tin chi tiáº¿t vá» tiáº¿n Ä‘á»™ Ä‘Ã¡nh giÃ¡
- **Dá»¯ liá»‡u bao gá»“m**:
  - ThÃ´ng tin cÆ¡ báº£n: MÃ£ SV, Há» tÃªn, Lá»›p, Khoa, TrÆ°á»ng
  - Tráº¡ng thÃ¡i Ä‘Ã¡nh giÃ¡: Sá»‘ minh chá»©ng Ä‘Ã£ duyá»‡t, chá» duyá»‡t, bá»‹ tá»« chá»‘i
  - Káº¿t quáº£ cuá»‘i cÃ¹ng: Danh hiá»‡u Ä‘áº¡t Ä‘Æ°á»£c, ngÃ y hoÃ n thÃ nh

### 2. Xuáº¥t bÃ¡o cÃ¡o minh chá»©ng
- **MÃ´ táº£**: Xuáº¥t danh sÃ¡ch táº¥t cáº£ minh chá»©ng vá»›i thÃ´ng tin chi tiáº¿t
- **Dá»¯ liá»‡u bao gá»“m**:
  - ThÃ´ng tin sinh viÃªn: MÃ£ SV, Há» tÃªn
  - ThÃ´ng tin minh chá»©ng: TÃªn minh chá»©ng, tiÃªu chÃ­, ngÃ y ná»™p
  - Tráº¡ng thÃ¡i: Tráº¡ng thÃ¡i duyá»‡t, ngÆ°á»i duyá»‡t, ngÃ y duyá»‡t, ghi chÃº

### 3. Xuáº¥t bÃ¡o cÃ¡o thá»‘ng kÃª tá»•ng quan
- **MÃ´ táº£**: Xuáº¥t bÃ¡o cÃ¡o thá»‘ng kÃª vá»›i 2 sheet
- **Sheet 1 - Thá»‘ng kÃª tá»•ng quan**:
  - Tá»•ng sá»‘ sinh viÃªn
  - Sá»‘ sinh viÃªn tham gia
  - Sá»‘ sinh viÃªn hoÃ n thÃ nh
  - Sá»‘ sinh viÃªn Ä‘áº¡t danh hiá»‡u
  - Tá»· lá»‡ hoÃ n thÃ nh vÃ  Ä‘áº¡t danh hiá»‡u
- **Sheet 2 - Thá»‘ng kÃª theo tiÃªu chÃ­**:
  - Sá»‘ minh chá»©ng theo tá»«ng tiÃªu chÃ­
  - PhÃ¢n loáº¡i theo tráº¡ng thÃ¡i (Ä‘Ã£ duyá»‡t, chá» duyá»‡t, bá»‹ tá»« chá»‘i)

## CÃ¡ch sá»­ dá»¥ng

### 1. Truy cáº­p form xuáº¥t bÃ¡o cÃ¡o
- ÄÄƒng nháº­p vÃ o há»‡ thá»‘ng vá»›i tÃ i khoáº£n cÃ³ quyá»n xuáº¥t bÃ¡o cÃ¡o
- Trong UserDashboard, click vÃ o tab "BÃ¡o cÃ¡o & Thá»‘ng kÃª"
- Click vÃ o button "Táº¡o bÃ¡o cÃ¡o" hoáº·c "Xuáº¥t Excel"

### 2. Chá»n loáº¡i bÃ¡o cÃ¡o
- **BÃ¡o cÃ¡o danh sÃ¡ch sinh viÃªn 5 tá»‘t**: Click button "ğŸ“Š BÃ¡o cÃ¡o danh sÃ¡ch sinh viÃªn 5 tá»‘t"
- **BÃ¡o cÃ¡o minh chá»©ng**: Click button "ğŸ“‹ BÃ¡o cÃ¡o minh chá»©ng"
- **BÃ¡o cÃ¡o thá»‘ng kÃª**: Click button "ğŸ“ˆ BÃ¡o cÃ¡o thá»‘ng kÃª tá»•ng quan"

### 3. Chá»n nÄƒm há»c
- Chá»n nÄƒm há»c tá»« dropdown (máº·c Ä‘á»‹nh lÃ  nÄƒm há»c hiá»‡n táº¡i)
- Click "Xuáº¥t bÃ¡o cÃ¡o" Ä‘á»ƒ báº¯t Ä‘áº§u

### 4. LÆ°u vÃ  má»Ÿ file
- Há»‡ thá»‘ng sáº½ táº¡o file Excel trong thÆ° má»¥c táº¡m
- Chá»n "CÃ³" Ä‘á»ƒ má»Ÿ file ngay sau khi xuáº¥t
- File sáº½ cÃ³ tÃªn theo format: `BaoCao_[Loai]_[NamHoc]_[NgayGio].xlsx`

## Æ¯u Ä‘iá»ƒm cá»§a há»‡ thá»‘ng má»›i

### 1. ÄÆ¡n giáº£n hÆ¡n
- KhÃ´ng cáº§n cáº¥u hÃ¬nh license nhÆ° EPPlus
- Sá»­ dá»¥ng ClosedXML - thÆ° viá»‡n miá»…n phÃ­ vÃ  á»•n Ä‘á»‹nh
- Code dá»… hiá»ƒu vÃ  báº£o trÃ¬

### 2. Hiá»‡u suáº¥t tá»‘t
- Xá»­ lÃ½ nhanh vá»›i dá»¯ liá»‡u lá»›n
- Tá»± Ä‘á»™ng Ä‘iá»u chá»‰nh Ä‘á»™ rá»™ng cá»™t
- Há»— trá»£ Ä‘á»‹nh dáº¡ng mÃ u sáº¯c theo tráº¡ng thÃ¡i

### 3. TÃ­nh nÄƒng phong phÃº
- Nhiá»u loáº¡i bÃ¡o cÃ¡o khÃ¡c nhau
- Thá»‘ng kÃª chi tiáº¿t theo tiÃªu chÃ­
- Xuáº¥t file vá»›i tÃªn tá»± Ä‘á»™ng

## Cáº¥u trÃºc file

### Services/ReportDtos.cs
- Chá»©a cÃ¡c DTO cho bÃ¡o cÃ¡o
- Äá»‹nh nghÄ©a cáº¥u trÃºc dá»¯ liá»‡u xuáº¥t

### Services/SimpleReportService.cs
- Service chÃ­nh xá»­ lÃ½ xuáº¥t bÃ¡o cÃ¡o
- CÃ¡c method xuáº¥t tá»«ng loáº¡i bÃ¡o cÃ¡o
- Xá»­ lÃ½ dá»¯ liá»‡u vÃ  táº¡o file Excel

### Winform/SimpleReportForm.cs
- Form giao diá»‡n xuáº¥t bÃ¡o cÃ¡o
- Xá»­ lÃ½ tÆ°Æ¡ng tÃ¡c ngÆ°á»i dÃ¹ng
- Gá»i service Ä‘á»ƒ xuáº¥t bÃ¡o cÃ¡o

## LÆ°u Ã½ ká»¹ thuáº­t

### 1. Dependencies
- **ClosedXML**: ThÆ° viá»‡n chÃ­nh Ä‘á»ƒ xá»­ lÃ½ Excel
- **Entity Framework**: Truy váº¥n dá»¯ liá»‡u tá»« database
- **System.IO**: Xá»­ lÃ½ file

### 2. Performance
- Sá»­ dá»¥ng `AsNoTracking()` cho cÃ¡c query chá»‰ Ä‘á»c
- Tá»‘i Æ°u hÃ³a Include Ä‘á»ƒ trÃ¡nh N+1 problem
- Xá»­ lÃ½ báº¥t Ä‘á»“ng bá»™ vá»›i async/await

### 3. Error Handling
- Try-catch cho táº¥t cáº£ operations
- Hiá»ƒn thá»‹ thÃ´ng bÃ¡o lá»—i rÃµ rÃ ng
- Fallback values cho dá»¯ liá»‡u null

## Troubleshooting

### 1. Lá»—i "KhÃ´ng thá»ƒ táº¡o file bÃ¡o cÃ¡o"
- Kiá»ƒm tra quyá»n ghi file trong thÆ° má»¥c táº¡m
- Äáº£m báº£o Ä‘á»§ dung lÆ°á»£ng á»• cá»©ng
- Kiá»ƒm tra káº¿t ná»‘i database

### 2. Lá»—i "KhÃ´ng tÃ¬m tháº¥y dá»¯ liá»‡u"
- Kiá»ƒm tra nÄƒm há»c Ä‘Ã£ chá»n cÃ³ dá»¯ liá»‡u khÃ´ng
- Kiá»ƒm tra quyá»n truy cáº­p dá»¯ liá»‡u cá»§a user
- Kiá»ƒm tra káº¿t ná»‘i database

### 3. File Excel bá»‹ lá»—i
- Äáº£m báº£o Ä‘Ã£ cÃ i Ä‘áº·t Microsoft Excel hoáº·c LibreOffice
- Kiá»ƒm tra file khÃ´ng bá»‹ corrupt
- Thá»­ xuáº¥t láº¡i vá»›i dá»¯ liá»‡u Ã­t hÆ¡n

## Káº¿t luáº­n

Há»‡ thá»‘ng xuáº¥t bÃ¡o cÃ¡o Ä‘Æ¡n giáº£n Ä‘Ã£ Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ thay tháº¿ EPPlus má»™t cÃ¡ch hiá»‡u quáº£, cung cáº¥p Ä‘áº§y Ä‘á»§ tÃ­nh nÄƒng cáº§n thiáº¿t vá»›i Ä‘á»™ phá»©c táº¡p tháº¥p hÆ¡n vÃ  hiá»‡u suáº¥t tá»‘t hÆ¡n.
